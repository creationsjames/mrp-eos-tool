<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MRP æ‹‹è½‰ EOS_YS æ•´åˆèˆ‡ GDP ä½œæ¥­æŒ‡å¼• (å®Œæ•´ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; }
        .chart-container { position: relative; width: 100%; max-width: 350px; margin: 0 auto; height: 250px; }
        .flow-node { transition: all 0.2s ease; cursor: pointer; border-left-width: 4px; }
        .flow-node:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .active-tab { border-bottom: 2px solid #2563eb; color: #2563eb; font-weight: 700; background-color: #eff6ff; }
        .inactive-tab { color: #64748b; font-weight: 500; }
        .inactive-tab:hover { color: #334155; background-color: #f1f5f9; }
        .detail-highlight { background-color: #fffbeb; border: 1px solid #fcd34d; padding: 2px 4px; rounded: 4px; font-family: monospace; color: #92400e; }
    </style>
</head>
<body class="text-slate-800 h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 shrink-0 z-10 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 h-14 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <span class="bg-blue-600 text-white p-1 rounded font-bold text-sm">MRP-EOS</span>
                <h1 class="font-bold text-slate-800">æ•´åˆèˆ‡ GDP ä½œæ¥­æŒ‡å¼• <span class="text-xs font-normal text-slate-500 bg-slate-100 px-2 py-0.5 rounded-full">v3.0 å®Œæ•´ç‰ˆ</span></h1>
            </div>
            <nav class="flex space-x-1">
                <button onclick="switchTab('workflow')" id="tab-workflow" class="active-tab px-4 py-2 text-sm rounded-t-lg transition-colors">æµç¨‹äº’å‹•åœ–</button>
                <button onclick="switchTab('simulator')" id="tab-simulator" class="inactive-tab px-4 py-2 text-sm rounded-t-lg transition-colors">æ‹‹è½‰æ¨¡æ“¬å™¨</button>
                <button onclick="switchTab('spec')" id="tab-spec" class="inactive-tab px-4 py-2 text-sm rounded-t-lg transition-colors">æŠ€è¡“è¦æ ¼èˆ‡è¨­å®š</button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow overflow-y-auto bg-slate-50 p-4">
        <div class="max-w-7xl mx-auto h-full">

            <!-- VIEW 1: WORKFLOW -->
            <section id="view-workflow" class="h-full flex flex-col lg:flex-row gap-6">
                <!-- Left: Flow Diagram -->
                <div class="lg:w-2/3 bg-white rounded-xl shadow-sm border border-slate-200 p-6 overflow-y-auto">
                    <h2 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <span>ğŸ“¦ ç³»çµ±ä½œæ¥­æµç¨‹ (é»æ“Šç¯€é»æŸ¥çœ‹ç´°ç¯€)</span>
                    </h2>
                    
                    <div class="space-y-6 relative">
                        <!-- Step 1 -->
                        <div onclick="showNodeDetail('step1')" class="flow-node border-l-blue-500 bg-white p-4 rounded border border-slate-200 hover:border-blue-300 shadow-sm group">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-bold text-blue-700 group-hover:text-blue-600">1. å–®æ“šç™»æ‰“ (MRPç«¯)</h3>
                                    <p class="text-xs text-slate-500 mt-1">IM330/340(é€²è²¨), IM380/390(å‡ºè²¨èª¿æ’¥)</p>
                                </div>
                                <span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded">èµ·é»</span>
                            </div>
                        </div>
                        
                        <!-- Arrow -->
                        <div class="flex justify-center -my-2"><span class="text-slate-300 text-xl">â†“</span></div>

                        <!-- Step 2 -->
                        <div onclick="showNodeDetail('step2')" class="flow-node border-l-amber-500 bg-white p-4 rounded border border-slate-200 hover:border-amber-300 shadow-sm group">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-bold text-amber-700 group-hover:text-amber-600">2. GDP æª¢æ ¸èˆ‡è¨˜éŒ„</h3>
                                    <p class="text-xs text-slate-500 mt-1">åˆ¤æ–· 14000åƒæ•¸ èˆ‡ GDPå±¬æ€§</p>
                                </div>
                                <span class="text-xs bg-amber-100 text-amber-700 px-2 py-1 rounded">è³‡æ–™åº«å¯«å…¥ gdptemp</span>
                            </div>
                        </div>

                        <!-- Arrow -->
                        <div class="flex justify-center -my-2"><span class="text-slate-300 text-xl">â†“</span></div>

                        <!-- Step 3 -->
                        <div onclick="showNodeDetail('step3')" class="flow-node border-l-purple-500 bg-white p-4 rounded border border-slate-200 hover:border-purple-300 shadow-sm group">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-bold text-purple-700 group-hover:text-purple-600">3. åŸ·è¡Œæ‹‹è½‰ç¨‹å¼ (CRMTG)</h3>
                                    <p class="text-xs text-slate-500 mt-1">æ‰‹å‹•åŸ·è¡Œ crmtg.exe</p>
                                </div>
                                <span class="text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded">ä¸­ä»‹åŒæ­¥</span>
                            </div>
                        </div>

                        <!-- Arrow -->
                        <div class="flex justify-center -my-2"><span class="text-slate-300 text-xl">â†“</span></div>

                        <!-- Step 4 -->
                        <div onclick="showNodeDetail('step4')" class="flow-node border-l-green-500 bg-white p-4 rounded border border-slate-200 hover:border-green-300 shadow-sm group">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-bold text-green-700 group-hover:text-green-600">4. ç‰©æµæ¥æ”¶èˆ‡å‡ºè²¨ (EOS_YS)</h3>
                                    <p class="text-xs text-slate-500 mt-1">æŒ‡å®šæ‰¹è™Ÿæ•ˆæœŸã€åˆ—å°å–®æ“š</p>
                                </div>
                                <span class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded">çµ‚é»</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right: Detail Panel -->
                <div class="lg:w-1/3 bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex flex-col sticky top-0">
                    <div id="detail-panel-content" class="h-full">
                        <div class="flex items-center gap-2 mb-4 text-slate-400">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            <span class="text-sm font-medium">è«‹é»æ“Šå·¦å´æµç¨‹åœ–æŸ¥çœ‹æŠ€è¡“ç´°ç¯€</span>
                        </div>
                        <div class="bg-slate-50 rounded p-4 text-sm text-slate-500 border border-slate-100">
                            <strong>æ“ä½œæç¤ºï¼š</strong><br>
                            å·¦å´æµç¨‹åœ–æ¶µè“‹äº†å¾ MRP å»ºç«‹å–®æ“šåˆ° EOS_YS å‡ºè²¨çš„å®Œæ•´ç”Ÿå‘½é€±æœŸã€‚é»æ“Šå„å€å¡Šå¯æŸ¥çœ‹å°æ‡‰çš„ Table è³‡æ–™è¡¨åç¨±èˆ‡è©³ç´°è¦å‰‡ã€‚
                        </div>
                    </div>
                </div>
            </section>

            <!-- VIEW 2: SIMULATOR -->
            <section id="view-simulator" class="hidden h-full flex flex-col lg:flex-row gap-6">
                <!-- Controls -->
                <div class="lg:w-1/2 bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                    <h2 class="text-lg font-bold mb-6 text-slate-800">IM151 æ‹‹è½‰é‚è¼¯æ¨¡æ“¬å™¨</h2>
                    
                    <div class="space-y-8">
                        <div>
                            <label class="block text-sm font-bold text-slate-700 mb-2">1. å–®æ“šé¡å‹</label>
                            <select id="sim-type" onchange="runSim()" class="w-full p-2 border border-slate-300 rounded bg-white text-sm focus:ring-2 focus:ring-blue-500 outline-none">
                                <option value="in">é€²è²¨ä½œæ¥­ (IM330/340)</option>
                                <option value="out">å‡ºè²¨/èª¿æ’¥ä½œæ¥­ (IM380/390)</option>
                            </select>
                        </div>

                        <div class="bg-slate-50 p-4 rounded border border-slate-200 space-y-4">
                            <h3 class="text-xs font-bold text-slate-500 uppercase tracking-wide">ä¸»è¦æ¢ä»¶ (æ±ºå®šå–®æ“šæ˜¯å¦éæª”)</h3>
                            
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="text-sm font-bold text-slate-700">åº«åˆ¥è¨­å®š (gdp110)</div>
                                    <div class="text-xs text-slate-500">ä¾†æº/ç›®çš„å€‰æ˜¯å¦æœ‰è¨­å®šå°æ‡‰ç‰©æµåº«?</div>
                                </div>
                                <input type="checkbox" id="sim-store" onchange="runSim()" class="w-5 h-5 text-blue-600 rounded">
                            </div>
                            <hr class="border-slate-200">
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="text-sm font-bold text-slate-700" id="sim-partner-label">å» å•† GDP è¨­å®š (pm100.gdp)</div>
                                    <div class="text-xs text-slate-500">äº¤æ˜“å°è±¡æ˜¯å¦è¨­å®š GDP=Y?</div>
                                </div>
                                <input type="checkbox" id="sim-partner" onchange="runSim()" class="w-5 h-5 text-blue-600 rounded">
                            </div>
                        </div>

                        <div class="bg-slate-50 p-4 rounded border border-slate-200 space-y-4">
                            <h3 class="text-xs font-bold text-slate-500 uppercase tracking-wide">æ¬¡è¦æ¢ä»¶ (æ±ºå®šæ˜ç´°æ˜¯å¦éæª”)</h3>
                            <div class="flex items-center justify-between">
                                <div>
                                    <div class="text-sm font-bold text-slate-700">å•†å“ GDP è¨­å®š (pd100.gdp)</div>
                                    <div class="text-xs text-slate-500">å•†å“æª”æ˜¯å¦è¨­å®š GDP=Y?</div>
                                </div>
                                <input type="checkbox" id="sim-item" onchange="runSim()" checked class="w-5 h-5 text-blue-600 rounded">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results -->
                <div class="lg:w-1/2 bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex flex-col items-center justify-center">
                    <div class="chart-container mb-6">
                        <canvas id="simChart"></canvas>
                    </div>
                    <div id="sim-result" class="text-center space-y-2">
                        <div class="text-2xl font-bold text-slate-300">è«‹è¨­å®šå·¦å´æ¢ä»¶</div>
                    </div>
                </div>
            </section>

            <!-- VIEW 3: SPECS & SETTINGS -->
            <section id="view-spec" class="hidden h-full">
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="grid grid-cols-1 md:grid-cols-4 min-h-[500px]">
                        <!-- Sidebar -->
                        <div class="bg-slate-50 border-r border-slate-200 p-2 space-y-1">
                            <button onclick="showSpec('req')" class="spec-btn w-full text-left px-4 py-3 text-sm rounded hover:bg-white hover:shadow-sm transition-all font-medium text-slate-600 bg-white shadow-sm border border-slate-200">ç³»çµ±éœ€æ±‚èˆ‡ç‰ˆæœ¬</button>
                            <button onclick="showSpec('setup')" class="spec-btn w-full text-left px-4 py-3 text-sm rounded hover:bg-white hover:shadow-sm transition-all font-medium text-slate-600">åƒæ•¸èˆ‡ SQR è¨­å®š</button>
                            <button onclick="showSpec('im151')" class="spec-btn w-full text-left px-4 py-3 text-sm rounded hover:bg-white hover:shadow-sm transition-all font-medium text-slate-600">IM151 è©³ç´°é…ç½®</button>
                            <button onclick="showSpec('rules')" class="spec-btn w-full text-left px-4 py-3 text-sm rounded hover:bg-white hover:shadow-sm transition-all font-medium text-slate-600">æ‹‹è½‰è¦å‰‡ç¸½çµ</button>
                        </div>
                        
                        <!-- Content -->
                        <div class="md:col-span-3 p-8 overflow-y-auto">
                            <!-- 1. Requirements -->
                            <div id="spec-req" class="spec-content space-y-6">
                                <h3 class="text-xl font-bold text-slate-800 border-b pb-2">è»Ÿé«”ç‰ˆæœ¬éœ€æ±‚</h3>
                                <ul class="list-disc list-inside space-y-3 text-sm text-slate-700">
                                    <li><span class="font-bold">MRP ç‰ˆæœ¬ï¼š</span>1960 (å«) ä»¥ä¸Š</li>
                                    <li><span class="font-bold">EOS_YS ç‰ˆæœ¬ï¼š</span>7037a (å«) ä»¥ä¸Š</li>
                                    <li><span class="font-bold">CRMTG æ‹‹è½‰ç¨‹å¼ï¼š</span>1961 (å«) ä»¥ä¸Š</li>
                                </ul>
                                <div class="bg-yellow-50 p-4 rounded border border-yellow-200 text-sm mt-4">
                                    <strong>ğŸ“‚ æª”æ¡ˆéƒ¨ç½²è·¯å¾‘ï¼š</strong>
                                    <ul class="list-disc list-inside mt-2 text-yellow-800">
                                        <li>è§£å£“ç¸® <code>crmtg_1961_xxxx.zip</code> è‡³ MRP ç›®éŒ„ã€‚</li>
                                        <li>è¤‡è£½ YS ç›®éŒ„ä¸‹çš„ <code>ercreos.ini</code> è‡³ MRP ç›®éŒ„ã€‚</li>
                                        <li>å»ºç«‹ <code>crmtg.exe</code> æ·å¾‘ (éœ€ä»¥ç³»çµ±ç®¡ç†å“¡åŸ·è¡Œ)ã€‚</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- 2. Setup -->
                            <div id="spec-setup" class="spec-content hidden space-y-6">
                                <h3 class="text-xl font-bold text-slate-800 border-b pb-2">MRP åƒæ•¸èˆ‡ SQR è¨­å®š</h3>
                                <div class="space-y-4">
                                    <div class="p-4 bg-slate-50 rounded border border-slate-200">
                                        <h4 class="font-bold text-blue-700 mb-2">å…¨åŸŸåƒæ•¸</h4>
                                        <p class="text-sm">è¨­å®š <code class="detail-highlight">14000 - GDP</code> ç‚º <strong>é–‹å•Ÿ</strong>ã€‚</p>
                                        <p class="text-xs text-slate-500 mt-1">å½±éŸ¿ç¯„åœï¼šIM340/380/390 é–‹å§‹è¨˜éŒ„ç•°å‹•è‡³ <code>gdptemp</code> è³‡æ–™è¡¨ã€‚</p>
                                    </div>
                                    <div class="p-4 bg-slate-50 rounded border border-slate-200">
                                        <h4 class="font-bold text-blue-700 mb-2">SQR å‚³è¼¸æ¬„ä½èª¿æ•´</h4>
                                        <ul class="list-disc list-inside text-sm space-y-2">
                                            <li>å¢åŠ ç¸½å€‰å‚³åˆ†å€‰æ¬„ä½ï¼š<code class="detail-highlight">pd100.gdp</code> (å•†å“å±¬æ€§)</li>
                                            <li>ç¢ºèªæ¬„ä½å‚³è¼¸ï¼š<code class="detail-highlight">pm100.gdp</code> (å» å•†å±¬æ€§)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- 3. IM151 -->
                            <div id="spec-im151" class="spec-content hidden space-y-6">
                                <h3 class="text-xl font-bold text-slate-800 border-b pb-2">IM151 è¨­å®šè©³è§£</h3>
                                <div class="overflow-x-auto">
                                    <table class="w-full text-sm text-left text-slate-600 border border-slate-200">
                                        <thead class="bg-slate-100 text-slate-800">
                                            <tr>
                                                <th class="p-3 border-b">è¨­å®šé …ç›® (Table)</th>
                                                <th class="p-3 border-b">é‚è¼¯èªªæ˜</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="border-b">
                                                <td class="p-3 font-mono text-blue-700">ç‰©æµåº«åˆ¥è¨­å®š (gdp110)</td>
                                                <td class="p-3">
                                                    è¨­å®š MRP åº«åˆ¥å°æ‡‰åˆ°çš„ YS åº«åˆ¥ã€‚<br>
                                                    <span class="text-xs text-slate-500">ä¾‹ï¼šMRPåº«(99) -> YSåº«(97)</span>
                                                </td>
                                            </tr>
                                            <tr class="border-b">
                                                <td class="p-3 font-mono text-blue-700">å•†å“è¨­å®š (pd100.gdp)</td>
                                                <td class="p-3">
                                                    å®šç¾©å“ªäº›æ˜¯ GDP å•†å“ã€‚<br>
                                                    <span class="text-xs text-slate-500">å»ºè­°ï¼šæ‹†åˆ†ä»£ç¢¼ï¼Œå¦‚ 00001(æµè²¨) / 00001R(GDPè²¨)ã€‚</span>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="p-3 font-mono text-blue-700">å» å•†è¨­å®š (pm100.gdp)</td>
                                                <td class="p-3">
                                                    å®šç¾©å“ªäº›å» å•†/å®¢æˆ¶éœ€èµ° GDP æµç¨‹ã€‚
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- 4. Rules -->
                            <div id="spec-rules" class="spec-content hidden space-y-6">
                                <h3 class="text-xl font-bold text-slate-800 border-b pb-2">æ‹‹è½‰è¦å‰‡ç¸½çµ</h3>
                                <ul class="list-decimal list-inside space-y-4 text-sm text-slate-700">
                                    <li>
                                        <strong>å–®å‘åŒæ­¥ï¼š</strong>
                                        è³‡æ–™æµç‚º MRP -> EOS_YSã€‚YS çš„ç•°å‹•(å¦‚æ€è²¨æ‰¹è™Ÿ)ä¸æœƒå›å¯« MRPã€‚
                                    </li>
                                    <li>
                                        <strong>åŸºæœ¬æª”åŒæ­¥ï¼š</strong>
                                        æ¯æ¬¡åŸ·è¡Œæ‹‹è½‰ç¨‹å¼ï¼Œæœƒè‡ªå‹•åŒæ­¥ <code>pd100</code>, <code>pm100</code>, <code>pd130</code>, <code>sa160</code> åˆ° YSã€‚
                                    </li>
                                    <li>
                                        <strong>å–®æ“šæ¿¾é™¤é‚è¼¯ï¼š</strong>
                                        <ul class="list-disc list-inside ml-4 mt-1 text-slate-500">
                                            <li>ä¸»è¦æ¢ä»¶ä¸ç¬¦ (åº«åˆ¥/å» å•†æœªè¨­) -> <strong>æ•´å¼µä¸æ‹‹</strong>ã€‚</li>
                                            <li>æ¬¡è¦æ¢ä»¶ä¸ç¬¦ (éGDPå•†å“) -> <strong>åƒ…æ¿¾é™¤è©²å•†å“</strong> (å–®æ“šé‡‘é¡æœƒé‡ç®—)ã€‚</li>
                                        </ul>
                                    </li>
                                    <li>
                                        <strong>æ“ä½œé˜²å‘†ï¼š</strong>
                                        æ‰‹å‹•å»ºç«‹èª¿æ’¥å–® (IM390) æ™‚ï¼Œå‹™å¿…å°‡ GDP èˆ‡é GDP å•†å“<strong>åˆ†å–®å»ºç«‹</strong>ã€‚
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <script>
        // --- DATA ---
        const nodeDetails = {
            'step1': {
                title: '1. å–®æ“šç™»æ‰“ (MRPç«¯)',
                desc: 'æ¡è³¼æˆ–åº«ç®¡äººå“¡æ–¼ MRP å»ºç«‹å–®æ“šã€‚',
                tech: [
                    'é€²è²¨ï¼šIM330 (é©—æ”¶), IM340 (é€²é€€è²¨)',
                    'å‡ºè²¨/èª¿æ’¥ï¼šIM380 (å‡ºé€€è²¨), IM390 (èª¿æ’¥)',
                    'é—œéµï¼šéœ€ä½¿ç”¨è¨­å®šæ–¼ IM110 çš„åº«åˆ¥ï¼Œç³»çµ±æ‰çŸ¥å°æ‡‰å» å•†/å®¢æˆ¶ã€‚'
                ]
            },
            'step2': {
                title: '2. GDP æª¢æ ¸èˆ‡è¨˜éŒ„',
                desc: 'å–®æ“šå­˜æª”ç•¶ä¸‹ï¼Œç³»çµ±è§¸ç™¼æª¢æ ¸ã€‚',
                tech: [
                    'åƒæ•¸ï¼š14000 - GDP å¿…é ˆé–‹å•Ÿ (Y)ã€‚',
                    'è¡Œç‚ºï¼šè‹¥å« GDP å•†å“ï¼Œä»‹é¢å¼·åˆ¶å¡«å¯«æ‰¹è™Ÿ/æ•ˆæœŸã€‚',
                    'è³‡æ–™æµï¼šç•°å‹•ç´€éŒ„å¯«å…¥ MRP è³‡æ–™åº«çš„ `gdptemp` è¡¨ï¼Œç­‰å¾…æ‹‹è½‰ã€‚'
                ]
            },
            'step3': {
                title: '3. åŸ·è¡Œæ‹‹è½‰ç¨‹å¼ (CRMTG)',
                desc: 'ä¸­ä»‹ç¨‹å¼è² è²¬æ¬é‹è³‡æ–™ã€‚',
                tech: [
                    'ç¨‹å¼ï¼š`crmtg.exe` (ç‰ˆæœ¬éœ€ > 1961)ã€‚',
                    'å‰ç½®å‹•ä½œï¼šç¨‹å¼å•Ÿå‹•æ™‚å…ˆåŒæ­¥ pd100, pm100, pd130, sa160 åˆ° YSã€‚',
                    'éæ¿¾æ ¸å¿ƒï¼šä¾æ“š IM151 è¨­å®š (gdp110, pd100.gdp, pm100.gdp) æ±ºå®šæ‹‹è½‰å…§å®¹ã€‚'
                ]
            },
            'step4': {
                title: '4. ç‰©æµæ¥æ”¶èˆ‡å‡ºè²¨ (EOS_YS)',
                desc: 'ç‰©æµç«¯æ¥æ”¶å–®æ“šä¸¦åŸ·è¡Œå¯¦é«”ä½œæ¥­ã€‚',
                tech: [
                    'æ‰¹è™Ÿç®¡ç†ï¼šç”± YS æŒ‡å®šå‡ºè²¨æ‰¹è™Ÿ (è‹¥åº«å­˜ä¸è¶³å‰‡ç„¡æ³•æ ¸å–®)ã€‚',
                    'é˜²å‘†ï¼šå»ºè­°é–‹å•Ÿ `14000 - SHIP`ï¼Œæœªæ ¸å–®ä¸å¯åˆ—å°ã€‚',
                    'æ³¨æ„ï¼šYS çš„ä¿®æ”¹ä¸æœƒå›å¯« MRPã€‚'
                ]
            }
        };

        // --- UI FUNCTIONS ---
        function switchTab(id) {
            ['workflow', 'simulator', 'spec'].forEach(t => {
                document.getElementById('view-' + t).classList.add('hidden');
                const btn = document.getElementById('tab-' + t);
                btn.classList.remove('active-tab');
                btn.classList.add('inactive-tab');
            });
            document.getElementById('view-' + id).classList.remove('hidden');
            const activeBtn = document.getElementById('tab-' + id);
            activeBtn.classList.remove('inactive-tab');
            activeBtn.classList.add('active-tab');

            if(id === 'simulator') initSim();
        }

        function showNodeDetail(id) {
            const d = nodeDetails[id];
            const listHtml = d.tech.map(t => `<li class="mb-1">${t}</li>`).join('');
            document.getElementById('detail-panel-content').innerHTML = `
                <div class="animate-fade-in">
                    <h3 class="text-xl font-bold text-slate-800 mb-2">${d.title}</h3>
                    <p class="text-slate-600 mb-4">${d.desc}</p>
                    <div class="bg-blue-50 border border-blue-100 rounded-lg p-4">
                        <h4 class="text-sm font-bold text-blue-800 mb-2 uppercase tracking-wide">æŠ€è¡“ç´°ç¯€ & è¦å‰‡</h4>
                        <ul class="list-disc list-inside text-sm text-slate-700 font-mono text-xs leading-relaxed">
                            ${listHtml}
                        </ul>
                    </div>
                </div>
            `;
        }

        function showSpec(id) {
            document.querySelectorAll('.spec-content').forEach(el => el.classList.add('hidden'));
            document.getElementById('spec-' + id).classList.remove('hidden');
            document.querySelectorAll('.spec-btn').forEach(btn => {
                btn.classList.remove('bg-white', 'shadow-sm', 'border', 'border-slate-200');
            });
            event.target.classList.add('bg-white', 'shadow-sm', 'border', 'border-slate-200');
        }

        // --- SIMULATOR ---
        let simChart = null;
        function initSim() {
            if(simChart) return;
            const ctx = document.getElementById('simChart').getContext('2d');
            simChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['æˆåŠŸæ‹‹è½‰', 'è¢«æ¿¾é™¤'],
                    datasets: [{ data: [0, 100], backgroundColor: ['#cbd5e1', '#e2e8f0'], borderWidth: 0 }]
                },
                options: { responsive: true, maintainAspectRatio: false, cutout: '75%', plugins: { legend: {display: false}, tooltip: {enabled: false} } }
            });
            runSim();
        }

        function runSim() {
            if(!simChart) return;
            const hasStore = document.getElementById('sim-store').checked;
            const hasPartner = document.getElementById('sim-partner').checked;
            const hasItem = document.getElementById('sim-item').checked;
            
            let color = '#cbd5e1'; 
            let data = [0, 100];
            let msg = '';
            let subMsg = '';

            // Logic matching "Primary/Secondary Conditions" from source
            if (!hasStore || !hasPartner) {
                // Primary Condition Failed
                color = '#ef4444'; // Red
                data = [0, 100];
                msg = '<span class="text-red-500">ä¸æ‹‹è½‰ (æ•´å¼µç•¥é)</span>';
                subMsg = 'ä¸»è¦æ¢ä»¶æœªé”æˆï¼šéœ€åŒæ™‚è¨­å®šåº«åˆ¥ (gdp110) èˆ‡ å» å•†å±¬æ€§ (pm100)ã€‚';
            } else {
                if (hasItem) {
                    // All Pass
                    color = '#22c55e'; // Green
                    data = [100, 0];
                    msg = '<span class="text-green-600">æˆåŠŸæ‹‹è½‰ (å®Œæ•´)</span>';
                    subMsg = 'ä¸»è¦æ¢ä»¶èˆ‡æ¬¡è¦æ¢ä»¶çš†ç¬¦åˆã€‚';
                } else {
                    // Secondary Failed (Partial)
                    color = '#eab308'; // Yellow
                    data = [50, 50];
                    msg = '<span class="text-yellow-600">éƒ¨åˆ†æ‹‹è½‰ (æ¿¾é™¤å•†å“)</span>';
                    subMsg = 'å–®æ“šæœƒéæª”ï¼Œä½†è©²å•†å“å› æœªè¨­ GDP=Y è€Œè¢«æ¿¾é™¤ï¼Œé‡‘é¡é‡ç®—ã€‚';
                }
            }
            
            simChart.data.datasets[0].backgroundColor = [color, '#f1f5f9'];
            simChart.data.datasets[0].data = data;
            simChart.update();
            document.getElementById('sim-result').innerHTML = `<div class="text-2xl font-bold">${msg}</div><div class="text-sm text-slate-500">${subMsg}</div>`;
        }
    </script>
</body>
</html>